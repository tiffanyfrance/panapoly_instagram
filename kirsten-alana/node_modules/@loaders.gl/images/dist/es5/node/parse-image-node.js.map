{"version":3,"sources":["../../../src/node/parse-image-node.js"],"names":["parseImageNode","arrayBuffer","options","getPixelsAsync","util","promisify","getPixels","mimeType","buffer","Buffer","from","ndarray","width","shape","height","data"],"mappings":";;;;;;;;;;;;;AACA;;AACA;;AACA;;SAEsBA,c;;;;;oFAAf,iBAA8BC,WAA9B,EAA2CC,OAA3C;AAAA;;AAAA;AAAA;AAAA;AAAA;AAGCC,YAAAA,cAHD,GAGkBC,iBAAKC,SAAL,CAAeC,qBAAf,CAHlB;AAAA,gCAKc,yCAAiBL,WAAjB,CALd,EAKEM,QALF,qBAKEA,QALF;AAMCC,YAAAA,MAND,GAMUP,WAAW,YAAYQ,MAAvB,GAAgCR,WAAhC,GAA8CQ,MAAM,CAACC,IAAP,CAAYT,WAAZ,CANxD;AAAA;AAAA,mBAQiBE,cAAc,CAACK,MAAD,EAASD,QAAT,CAR/B;;AAAA;AAQCI,YAAAA,OARD;AAAA,6CASE;AACLC,cAAAA,KAAK,EAAED,OAAO,CAACE,KAAR,CAAc,CAAd,CADF;AAELC,cAAAA,MAAM,EAAEH,OAAO,CAACE,KAAR,CAAc,CAAd,CAFH;AAGLE,cAAAA,IAAI,EAAEJ,OAAO,CAACI;AAHT,aATF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["/* global Buffer */\nimport getPixels from 'get-pixels';\nimport util from 'util';\nimport {getImageMetadata} from '../lib/get-image-metadata';\n\nexport async function parseImageNode(arrayBuffer, options) {\n  // TODO - check if getPixels callback is asynchronous if provided with buffer input\n  // if not, parseImage can be a sync function\n  const getPixelsAsync = util.promisify(getPixels);\n\n  const {mimeType} = getImageMetadata(arrayBuffer);\n  const buffer = arrayBuffer instanceof Buffer ? arrayBuffer : Buffer.from(arrayBuffer);\n\n  const ndarray = await getPixelsAsync(buffer, mimeType);\n  return {\n    width: ndarray.shape[0],\n    height: ndarray.shape[1],\n    data: ndarray.data\n  };\n}\n"],"file":"parse-image-node.js"}