{"version":3,"sources":["../../../src/node/parse-image-node.js"],"names":["getPixels","util","getImageMetadata","parseImageNode","arrayBuffer","options","getPixelsAsync","promisify","mimeType","buffer","Buffer","from","ndarray","width","shape","height","data"],"mappings":";AACA,OAAOA,SAAP,MAAsB,YAAtB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,SAAQC,gBAAR,QAA+B,2BAA/B;AAEA,gBAAsBC,cAAtB;AAAA;AAAA;;;sCAAO,WAA8BC,WAA9B,EAA2CC,OAA3C,EAAoD;AAGzD,UAAMC,cAAc,GAAGL,IAAI,CAACM,SAAL,CAAeP,SAAf,CAAvB;;AAHyD,8BAKtCE,gBAAgB,CAACE,WAAD,CALsB;AAAA,UAKlDI,QALkD,qBAKlDA,QALkD;;AAMzD,UAAMC,MAAM,GAAGL,WAAW,YAAYM,MAAvB,GAAgCN,WAAhC,GAA8CM,MAAM,CAACC,IAAP,CAAYP,WAAZ,CAA7D;AAEA,UAAMQ,OAAO,SAASN,cAAc,CAACG,MAAD,EAASD,QAAT,CAApC;AACA,WAAO;AACLK,MAAAA,KAAK,EAAED,OAAO,CAACE,KAAR,CAAc,CAAd,CADF;AAELC,MAAAA,MAAM,EAAEH,OAAO,CAACE,KAAR,CAAc,CAAd,CAFH;AAGLE,MAAAA,IAAI,EAAEJ,OAAO,CAACI;AAHT,KAAP;AAKD,G","sourcesContent":["/* global Buffer */\nimport getPixels from 'get-pixels';\nimport util from 'util';\nimport {getImageMetadata} from '../lib/get-image-metadata';\n\nexport async function parseImageNode(arrayBuffer, options) {\n  // TODO - check if getPixels callback is asynchronous if provided with buffer input\n  // if not, parseImage can be a sync function\n  const getPixelsAsync = util.promisify(getPixels);\n\n  const {mimeType} = getImageMetadata(arrayBuffer);\n  const buffer = arrayBuffer instanceof Buffer ? arrayBuffer : Buffer.from(arrayBuffer);\n\n  const ndarray = await getPixelsAsync(buffer, mimeType);\n  return {\n    width: ndarray.shape[0],\n    height: ndarray.shape[1],\n    data: ndarray.data\n  };\n}\n"],"file":"parse-image-node.js"}