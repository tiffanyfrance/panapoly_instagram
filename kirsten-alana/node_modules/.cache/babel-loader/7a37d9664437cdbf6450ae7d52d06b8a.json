{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _get from \"@babel/runtime/helpers/esm/get\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport LayersPass from './layers-pass';\nimport { withParameters } from '@luma.gl/core';\n\nvar PickLayersPass = function (_LayersPass) {\n  _inherits(PickLayersPass, _LayersPass);\n\n  function PickLayersPass() {\n    _classCallCheck(this, PickLayersPass);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(PickLayersPass).apply(this, arguments));\n  }\n\n  _createClass(PickLayersPass, [{\n    key: \"render\",\n    value: function render(props) {\n      if (props.pickingFBO) {\n        this.drawPickingBuffer(props);\n      } else {\n        _get(_getPrototypeOf(PickLayersPass.prototype), \"render\", this).call(this, props);\n      }\n    }\n  }, {\n    key: \"drawPickingBuffer\",\n    value: function drawPickingBuffer(_ref) {\n      var _this = this;\n\n      var layers = _ref.layers,\n          viewports = _ref.viewports,\n          onViewportActive = _ref.onViewportActive,\n          pickingFBO = _ref.pickingFBO,\n          effectProps = _ref.effectProps,\n          _ref$deviceRect = _ref.deviceRect,\n          x = _ref$deviceRect.x,\n          y = _ref$deviceRect.y,\n          width = _ref$deviceRect.width,\n          height = _ref$deviceRect.height,\n          _ref$redrawReason = _ref.redrawReason,\n          redrawReason = _ref$redrawReason === void 0 ? '' : _ref$redrawReason;\n      var gl = this.gl;\n      return withParameters(gl, {\n        framebuffer: pickingFBO,\n        scissorTest: true,\n        scissor: [x, y, width, height],\n        clearColor: [0, 0, 0, 0]\n      }, function () {\n        _this.drawLayers({\n          layers: layers,\n          viewports: viewports,\n          onViewportActive: onViewportActive,\n          pass: 'picking',\n          redrawReason: redrawReason,\n          effectProps: effectProps,\n          parameters: {\n            blend: true,\n            blendFunc: [1, 0, 32771, 0],\n            blendEquation: 32774,\n            blendColor: [0, 0, 0, 0],\n            depthMask: true,\n            depthTest: true,\n            depthRange: [0, 1],\n            colorMask: [true, true, true, true]\n          }\n        });\n      });\n    }\n  }, {\n    key: \"shouldDrawLayer\",\n    value: function shouldDrawLayer(layer, viewport) {\n      var layerFilter = this.props.layerFilter;\n      var shouldDrawLayer = !layer.isComposite && layer.props.visible && layer.props.pickable;\n\n      if (shouldDrawLayer && layerFilter) {\n        shouldDrawLayer = layerFilter({\n          layer: layer,\n          viewport: viewport,\n          isPicking: true\n        });\n      }\n\n      return shouldDrawLayer;\n    }\n  }, {\n    key: \"getModuleParameters\",\n    value: function getModuleParameters(layer, effects, effectProps) {\n      var moduleParameters = Object.assign(Object.create(layer.props), {\n        viewport: layer.context.viewport,\n        pickingActive: 1,\n        devicePixelRatio: this.props.pixelRatio\n      });\n      Object.assign(moduleParameters, effectProps);\n      return moduleParameters;\n    }\n  }, {\n    key: \"getLayerParameters\",\n    value: function getLayerParameters(layer, layerIndex, glViewport, parameters) {\n      var layerParameters = Object.assign({}, layer.props.parameters || {}, parameters);\n      Object.assign(layerParameters, {\n        viewport: glViewport,\n        blendColor: [0, 0, 0, (layerIndex + 1) / 255]\n      });\n      return layerParameters;\n    }\n  }]);\n\n  return PickLayersPass;\n}(LayersPass);\n\nexport { PickLayersPass as default };","map":null,"metadata":{},"sourceType":"module"}