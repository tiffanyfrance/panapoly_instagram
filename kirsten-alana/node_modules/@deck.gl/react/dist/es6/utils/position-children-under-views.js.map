{"version":3,"sources":["../../../src/utils/position-children-under-views.js"],"names":["createElement","View","log","inheritsFrom","evaluateChildren","positionChildrenUnderViews","children","viewports","deck","viewManager","views","length","defaultViewId","id","map","child","i","props","viewportId","removed","viewId","viewChildren","type","viewport","getViewport","viewState","getViewState","x","y","width","height","style","position","left","top","key"],"mappings":"AAAA,SAAQA,aAAR,QAA4B,OAA5B;AACA,SAAQC,IAAR,EAAcC,GAAd,QAAwB,eAAxB;AACA,SAAQC,YAAR,QAA2B,iBAA3B;AACA,OAAOC,gBAAP,MAA6B,qBAA7B;AAIA,eAAe,SAASC,0BAAT,OAAiE;AAAA,MAA5BC,QAA4B,QAA5BA,QAA4B;AAAA,MAAlBC,SAAkB,QAAlBA,SAAkB;AAAA,MAAPC,IAAO,QAAPA,IAAO;;AAAA,gBACxDA,IAAI,IAAI,EADgD;AAAA,QACvEC,WADuE,SACvEA,WADuE;;AAG9E,MAAI,CAACA,WAAD,IAAgB,CAACA,WAAW,CAACC,KAAZ,CAAkBC,MAAvC,EAA+C;AAC7C,WAAO,EAAP;AACD;;AAED,QAAMC,aAAa,GAAGH,WAAW,CAACC,KAAZ,CAAkB,CAAlB,EAAqBG,EAA3C;AAEA,SAAOP,QAAQ,CAACQ,GAAT,CAAa,CAACC,KAAD,EAAQC,CAAR,KAAc;AAChC,QAAID,KAAK,CAACE,KAAN,CAAYC,UAAhB,EAA4B;AAC1BhB,MAAAA,GAAG,CAACiB,OAAJ,CAAY,YAAZ,EAA0B,QAA1B;AACD;;AACD,QAAIJ,KAAK,CAACE,KAAN,CAAYG,MAAhB,EAAwB;AACtBlB,MAAAA,GAAG,CAACiB,OAAJ,CAAY,QAAZ,EAAsB,QAAtB;AACD;;AAGD,QAAIC,MAAM,GAAGR,aAAb;AACA,QAAIS,YAAY,GAAGN,KAAnB;;AACA,QAAIZ,YAAY,CAACY,KAAK,CAACO,IAAP,EAAarB,IAAb,CAAhB,EAAoC;AAClCmB,MAAAA,MAAM,GAAGL,KAAK,CAACE,KAAN,CAAYJ,EAAZ,IAAkBD,aAA3B;AACAS,MAAAA,YAAY,GAAGN,KAAK,CAACE,KAAN,CAAYX,QAA3B;AACD;;AAED,UAAMiB,QAAQ,GAAGd,WAAW,CAACe,WAAZ,CAAwBJ,MAAxB,CAAjB;AACA,UAAMK,SAAS,GAAGhB,WAAW,CAACiB,YAAZ,CAAyBN,MAAzB,CAAlB;;AAGA,QAAI,CAACG,QAAL,EAAe;AACb,aAAO,IAAP;AACD;;AAtB+B,UAyBzBI,CAzByB,GAyBFJ,QAzBE,CAyBzBI,CAzByB;AAAA,UAyBtBC,CAzBsB,GAyBFL,QAzBE,CAyBtBK,CAzBsB;AAAA,UAyBnBC,KAzBmB,GAyBFN,QAzBE,CAyBnBM,KAzBmB;AAAA,UAyBZC,MAzBY,GAyBFP,QAzBE,CAyBZO,MAzBY;AA2BhCT,IAAAA,YAAY,GAAGjB,gBAAgB,CAACiB,YAAD,EAAe;AAC5CM,MAAAA,CAD4C;AAE5CC,MAAAA,CAF4C;AAG5CC,MAAAA,KAH4C;AAI5CC,MAAAA,MAJ4C;AAK5CP,MAAAA,QAL4C;AAM5CE,MAAAA;AAN4C,KAAf,CAA/B;AASA,UAAMM,KAAK,GAAG;AAACC,MAAAA,QAAQ,EAAE,UAAX;AAAuBC,MAAAA,IAAI,EAAEN,CAA7B;AAAgCO,MAAAA,GAAG,EAAEN,CAArC;AAAwCC,MAAAA,KAAxC;AAA+CC,MAAAA;AAA/C,KAAd;AACA,UAAMK,GAAG,GAAI,cAAaf,MAAO,IAAGJ,CAAE,EAAtC;AACA,WAAOhB,aAAa,CAAC,KAAD,EAAQ;AAACmC,MAAAA,GAAD;AAAMtB,MAAAA,EAAE,EAAEsB,GAAV;AAAeJ,MAAAA;AAAf,KAAR,EAA+BV,YAA/B,CAApB;AACD,GAvCM,CAAP;AAwCD","sourcesContent":["import {createElement} from 'react';\nimport {View, log} from '@deck.gl/core';\nimport {inheritsFrom} from './inherits-from';\nimport evaluateChildren from './evaluate-children';\n\n// Iterate over views and reposition children associated with views\n// TODO - Can we supply a similar function for the non-React case?\nexport default function positionChildrenUnderViews({children, viewports, deck}) {\n  const {viewManager} = deck || {};\n\n  if (!viewManager || !viewManager.views.length) {\n    return [];\n  }\n\n  const defaultViewId = viewManager.views[0].id;\n\n  return children.map((child, i) => {\n    if (child.props.viewportId) {\n      log.removed('viewportId', '<View>')();\n    }\n    if (child.props.viewId) {\n      log.removed('viewId', '<View>')();\n    }\n\n    // Unless child is a View, position / render as part of the default view\n    let viewId = defaultViewId;\n    let viewChildren = child;\n    if (inheritsFrom(child.type, View)) {\n      viewId = child.props.id || defaultViewId;\n      viewChildren = child.props.children;\n    }\n\n    const viewport = viewManager.getViewport(viewId);\n    const viewState = viewManager.getViewState(viewId);\n\n    // Drop (auto-hide) elements with viewId that are not matched by any current view\n    if (!viewport) {\n      return null;\n    }\n\n    // Resolve potentially relative dimensions using the deck.gl container size\n    const {x, y, width, height} = viewport;\n\n    viewChildren = evaluateChildren(viewChildren, {\n      x,\n      y,\n      width,\n      height,\n      viewport,\n      viewState\n    });\n\n    const style = {position: 'absolute', left: x, top: y, width, height};\n    const key = `view-child-${viewId}-${i}`;\n    return createElement('div', {key, id: key, style}, viewChildren);\n  });\n}\n"],"file":"position-children-under-views.js"}