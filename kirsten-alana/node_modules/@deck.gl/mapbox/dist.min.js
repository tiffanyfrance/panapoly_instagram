!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("deck"));else if("function"==typeof define&&define.amd)define(["deck"],t);else{var r="object"==typeof exports?t(require("deck")):t(e.deck);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(t,r){t.exports=e},function(e,t,r){(function(t){const n=r(3),o=("undefined"==typeof window?t:window).deck||{};if(!o.Layer)throw new Error("@deck.gl/core is not found");e.exports=Object.assign(o,n)}).call(this,r(2))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r.r(t);var n=r(0);function o({map:e,gl:t,deck:r}){if(e.__deck)return e.__deck;const o={useDevicePixels:!0,_customRender:()=>e.triggerRepaint(),parameters:{depthMask:!0,depthTest:!0,blendFunc:[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],blendEquation:t.FUNC_ADD},userData:{isExternal:!1,mapboxLayers:new Set}};return r?(r.setProps(o),r.props.userData.isExternal=!0):(Object.assign(o,{gl:t,width:!1,height:!1}),r=new n.Deck(o),e.on("remove",()=>{r.finalize(),e.__deck=null})),e.__deck=r,e.on("render",()=>(function(e,t){const{mapboxLayers:r,isExternal:n}=e.props.userData;if(n){const n=i(t,{nearZMultiplier:.1,farZMultiplier:10});e.setProps({viewState:n});const o=Array.from(r,e=>e.id),u=s(e,e=>{for(const t of o)if(a(t,e))return!1;return!0});u.length>0&&e._drawLayers("mapbox-repaint",{layers:u,clearCanvas:!1})}e.needsRedraw({clearRedrawFlags:!0})})(r,e)),r}function i(e,t){const{lng:r,lat:n}=e.getCenter();return Object.assign({longitude:r,latitude:n,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch()},t)}function s(e,t){return e.layerManager.getLayers().filter(t)}function a(e,t){let r=t;for(;r;){if(r.id===e)return!0;r=r.parent}return!1}function u(e){if(e.props.userData.isExternal)return;const t=[];e.props.userData.mapboxLayers.forEach(e=>{const r=new(0,e.props.type)(e.props);t.push(r)}),e.setProps({layers:t})}class c{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,t){var r,n;this.map=e,this.deck=o({map:e,gl:t,deck:this.props.deck}),r=this.deck,n=this,r.props.userData.mapboxLayers.add(n),u(r)}onRemove(){var e,t;e=this.deck,t=this,e.props.userData.mapboxLayers.delete(t),u(e)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&u(this.deck)}render(e,t){var r,n;this.deck.setProps({viewState:this._getViewState()}),r=this.deck,n=this,r._drawLayers("mapbox-repaint",{layers:s(r,e=>a(n.id,e)),clearCanvas:!1})}_getViewState(){const{map:e,deck:t}=this;return i(e,{nearZMultiplier:t.height?1/t.height:1,farZMultiplier:1})}}r.d(t,"MapboxLayer",function(){return c})}])});